nohup: ignoring input
/private/workspace/environment/sam_adapt/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: libc10_cuda.so: cannot open shared object file: No such file or directory
  warn(f"Failed to load image Python extension: {e}")
Argument list to program
--relative_age True
--chronological_age True
--gender_multiplier True
--use_gut_microbiome False
--use_pe_performance False
--cropped False
--dataset KG
--data_train /private/workspace/cyt/bone_age_assessment/data/data_yuwei/train
--heatmaps_train ./experiments/best_experiment/KG/with_no_pe_gut/HEATMAPS_TRAIN
--ann_path_train /private/workspace/cyt/bone_age_assessment/data/data_yuwei/annotations/train_ann.csv
--rois_path_train /private/workspace/cyt/bone_age_assessment/data/RSNA/annotations/RSNA_Anatomical_ROIs_Training.json
--data_val /private/workspace/cyt/bone_age_assessment/data/data_yuwei/val
--heatmaps_val ./experiments/best_experiment/KG/with_no_pe_gut/HEATMAPS_VAL
--ann_path_val /private/workspace/cyt/bone_age_assessment/data/data_yuwei/annotations/val_ann.csv
--rois_path_val /private/workspace/cyt/bone_age_assessment/data/RSNA/annotations/RSNA_Anatomical_ROIs_Validation.json
--trainval True
--save_folder ./experiments/best_experiment/KG/with_no_pe_gut
--snapshot ./experiments/best_experiment/KG/with_no_pe_gut/boneage_bonet_snapshot.pth
--optim_snapshot ./experiments/best_experiment/KG/with_no_pe_gut/boneage_bonet_optim.pth
--eval_first True
--workers 25
--batch_size 20
--epochs 150
--lr 0.0001
--patience 2
--start_epoch 0
--seed 1111
--log_interval 30
--gpu 0
--rank 0



---> Number of params: 123388203
Train begins...
Val loss: 6465083972134.53809
 [    0] (    0/   24) | ms/batch 11198.6182 | loss 48.957954 | avg loss 48.957954 | lr 0.0001000
Val loss: 17.98402
-----------------------------------------------------------------------------------------
| end of epoch   0 | time: 192.61s | epoch loss 53.075917 |
-----------------------------------------------------------------------------------------
 [    1] (    0/   24) | ms/batch 10372.4971 | loss 20.589731 | avg loss 20.589731 | lr 0.0001000
Val loss: 11.13839
-----------------------------------------------------------------------------------------
| end of epoch   1 | time: 121.88s | epoch loss 23.557014 |
-----------------------------------------------------------------------------------------
 [    2] (    0/   24) | ms/batch 9253.3610 | loss 17.421227 | avg loss 17.421227 | lr 0.0001000
Val loss: 15.73129
-----------------------------------------------------------------------------------------
| end of epoch   2 | time: 115.79s | epoch loss 21.791401 |
-----------------------------------------------------------------------------------------
 [    3] (    0/   24) | ms/batch 9308.5942 | loss 20.277191 | avg loss 20.277191 | lr 0.0001000
Val loss: 9.93466
-----------------------------------------------------------------------------------------
| end of epoch   3 | time: 110.17s | epoch loss 16.980675 |
-----------------------------------------------------------------------------------------
 [    4] (    0/   24) | ms/batch 9068.3975 | loss 15.638083 | avg loss 15.638083 | lr 0.0001000
Val loss: 15.87885
-----------------------------------------------------------------------------------------
| end of epoch   4 | time: 115.85s | epoch loss 17.150477 |
-----------------------------------------------------------------------------------------
 [    5] (    0/   24) | ms/batch 9455.7068 | loss 23.690708 | avg loss 23.690708 | lr 0.0001000
Val loss: 10.85017
-----------------------------------------------------------------------------------------
| end of epoch   5 | time: 113.11s | epoch loss 17.782129 |
-----------------------------------------------------------------------------------------
 [    6] (    0/   24) | ms/batch 9951.7007 | loss 13.319387 | avg loss 13.319387 | lr 0.0001000
Val loss: 20.22698
-----------------------------------------------------------------------------------------
| end of epoch   6 | time: 116.76s | epoch loss 14.602175 |
-----------------------------------------------------------------------------------------
 [    7] (    0/   24) | ms/batch 8966.2113 | loss 21.389444 | avg loss 21.389444 | lr 0.0001000
Val loss: 10.59964
-----------------------------------------------------------------------------------------
| end of epoch   7 | time: 115.43s | epoch loss 16.056746 |
-----------------------------------------------------------------------------------------
 [    8] (    0/   24) | ms/batch 9449.6121 | loss 12.001493 | avg loss 12.001493 | lr 0.0001000
Val loss: 10.80385
-----------------------------------------------------------------------------------------
| end of epoch   8 | time: 112.84s | epoch loss 13.571279 |
-----------------------------------------------------------------------------------------
 [    9] (    0/   24) | ms/batch 8904.8033 | loss 19.186827 | avg loss 19.186827 | lr 0.0001000
Val loss: 11.28882
-----------------------------------------------------------------------------------------
| end of epoch   9 | time: 119.39s | epoch loss 13.196313 |
-----------------------------------------------------------------------------------------
 [   10] (    0/   24) | ms/batch 9503.1028 | loss 11.422420 | avg loss 11.422420 | lr 0.0001000
Val loss: 8.45185
-----------------------------------------------------------------------------------------
| end of epoch  10 | time: 115.19s | epoch loss 14.282272 |
-----------------------------------------------------------------------------------------
 [   11] (    0/   24) | ms/batch 8864.2504 | loss 12.601278 | avg loss 12.601278 | lr 0.0001000
Val loss: 12.93895
-----------------------------------------------------------------------------------------
| end of epoch  11 | time: 110.60s | epoch loss 12.094353 |
-----------------------------------------------------------------------------------------
 [   12] (    0/   24) | ms/batch 8971.6613 | loss 20.002811 | avg loss 20.002811 | lr 0.0001000
Val loss: 8.58518
-----------------------------------------------------------------------------------------
| end of epoch  12 | time: 113.01s | epoch loss 13.606714 |
-----------------------------------------------------------------------------------------
 [   13] (    0/   24) | ms/batch 9387.6507 | loss 7.108373 | avg loss 7.108373 | lr 0.0001000
Val loss: 10.60374
-----------------------------------------------------------------------------------------
| end of epoch  13 | time: 114.92s | epoch loss 10.416097 |
-----------------------------------------------------------------------------------------
 [   14] (    0/   24) | ms/batch 9845.9098 | loss 10.625073 | avg loss 10.625073 | lr 0.0001000
Val loss: 8.34132
-----------------------------------------------------------------------------------------
| end of epoch  14 | time: 118.49s | epoch loss 10.759909 |
-----------------------------------------------------------------------------------------
 [   15] (    0/   24) | ms/batch 9264.1902 | loss 7.872686 | avg loss 7.872686 | lr 0.0001000
Val loss: 8.11194
-----------------------------------------------------------------------------------------
| end of epoch  15 | time: 120.00s | epoch loss 11.631353 |
-----------------------------------------------------------------------------------------
 [   16] (    0/   24) | ms/batch 9411.9620 | loss 8.919968 | avg loss 8.919968 | lr 0.0001000
Val loss: 9.28980
-----------------------------------------------------------------------------------------
| end of epoch  16 | time: 115.89s | epoch loss 10.441794 |
-----------------------------------------------------------------------------------------
 [   17] (    0/   24) | ms/batch 9739.0771 | loss 11.073275 | avg loss 11.073275 | lr 0.0001000
Val loss: 8.92118
-----------------------------------------------------------------------------------------
| end of epoch  17 | time: 111.23s | epoch loss 9.440238 |
-----------------------------------------------------------------------------------------
 [   18] (    0/   24) | ms/batch 9023.1602 | loss 7.386299 | avg loss 7.386299 | lr 0.0001000
Val loss: 9.00526
-----------------------------------------------------------------------------------------
| end of epoch  18 | time: 106.48s | epoch loss 10.448875 |
-----------------------------------------------------------------------------------------
 [   19] (    0/   24) | ms/batch 9051.4350 | loss 12.753492 | avg loss 12.753492 | lr 0.0001000
Val loss: 8.08885
-----------------------------------------------------------------------------------------
| end of epoch  19 | time: 114.49s | epoch loss 10.112881 |
-----------------------------------------------------------------------------------------
 [   20] (    0/   24) | ms/batch 9193.3227 | loss 11.062155 | avg loss 11.062155 | lr 0.0001000
Val loss: 8.36729
-----------------------------------------------------------------------------------------
| end of epoch  20 | time: 112.57s | epoch loss 9.983024 |
-----------------------------------------------------------------------------------------
